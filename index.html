<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Name Your Beast ‚Äî The ADHD Trait-to-Tool Map</title>
<style>
/* --- CORE STYLES FROM V3 --- */
@import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=DM+Sans:wght@400;500;700&display=swap');

:root {
  --red: #E8443A; --yellow: #F5A623; --blue: #4A90D9; --green: #5CB85C;
  --purple: #8E6FBF; --dark: #1E1E2E; --darker: #14141F;
  --card-bg: #252540; --card-hover: #2E2E50; --text-main: #E8E8F0;
  --text-muted: #9595B0; --accent: #FF6B6B; --glow: rgba(255, 107, 107, 0.15);
}

* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'DM Sans', sans-serif; background: var(--darker); color: var(--text-main); min-height: 100vh; overflow-x: hidden; }

/* Texture overlay */
body::before { content: ''; position: fixed; inset: 0; background: url("data:image/svg+xml,%3Csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E"); pointer-events: none; z-index: 0; }

/* --- HERO & NAV --- */
.hero { position: relative; padding: 4rem 2rem 3rem; text-align: center; background: linear-gradient(135deg, var(--darker) 0%, #1a1a35 50%, var(--darker) 100%); border-bottom: 1px solid rgba(255,255,255,0.04); }
.hero h1 { font-family: 'Fredoka', sans-serif; font-size: clamp(2.2rem, 5vw, 3.6rem); font-weight: 700; line-height: 1.15; background: linear-gradient(135deg, #FF6B6B, #FFD93D, #6BCB77, #4D96FF); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 0.75rem; }
.hero .subtitle { font-size: 1.15rem; color: var(--text-muted); max-width: 600px; margin: 0 auto 1.5rem; line-height: 1.55; }
.hero .source-note { font-size: 0.8rem; color: #666; font-style: italic; }

.nav-bar { position: sticky; top: 0; z-index: 100; background: rgba(20, 20, 31, 0.92); backdrop-filter: blur(16px); border-bottom: 1px solid rgba(255,255,255,0.06); padding: 0.6rem 1rem; display: flex; gap: 0.5rem; overflow-x: auto; justify-content: center; }
.nav-btn { font-family: 'DM Sans', sans-serif; font-size: 0.85rem; font-weight: 600; padding: 0.5rem 1.1rem; border: 1px solid rgba(255,255,255,0.08); border-radius: 999px; background: transparent; color: var(--text-muted); cursor: pointer; transition: all 0.2s; white-space: nowrap; }
.nav-btn:hover { background: rgba(255,255,255,0.06); color: var(--text-main); }
.nav-btn.active { background: var(--accent); color: #fff; border-color: var(--accent); }
.nav-btn.nav-myday.active { background: #6BCB77; color: #000; border-color: #6BCB77; }
.nav-btn.nav-fav.active { background: #FFD93D; color: #000; border-color: #FFD93D; }

/* --- LANGUAGE PICKER --- */
.lang-picker { position: absolute; top: 1rem; right: 1.5rem; z-index: 101; display: flex; align-items: center; gap: 0.4rem; background: rgba(20, 20, 31, 0.6); backdrop-filter: blur(8px); border: 1px solid rgba(255,255,255,0.1); border-radius: 999px; padding: 0.2rem 0.8rem 0.2rem 0.6rem; transition: all 0.2s; }
.lang-picker:hover { background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.2); }
.lang-icon { font-size: 0.9rem; opacity: 0.8; }
.lang-picker select { background: transparent; color: var(--text-muted); font-family: 'DM Sans', sans-serif; font-size: 0.85rem; font-weight: 600; border: none; outline: none; cursor: pointer; appearance: none; -webkit-appearance: none; padding-right: 10px; }
.lang-picker select:hover, .lang-picker select:focus { color: var(--text-main); }
.lang-picker select option { background: var(--darker); color: var(--text-main); }

/* --- CARDS & GRIDS --- */
.container { max-width: 1100px; margin: 0 auto; padding: 2rem 1.5rem 4rem; }
.page { display: none; }
.page.active { display: block; animation: pageFadeIn 0.25s ease; }
@keyframes pageFadeIn { from { opacity: 0; } to { opacity: 1; } }

.trait-grid { display: grid; grid-template-columns: 1fr; gap: 1.25rem; }
.trait-card { background: var(--card-bg); border-radius: 16px; border: 1px solid rgba(255,255,255,0.05); overflow: hidden; transition: transform 0.2s; }
.trait-card:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(0,0,0,0.3); }
.trait-header { padding: 1.25rem 1.5rem; cursor: pointer; display: flex; align-items: center; gap: 1rem; }
.trait-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; flex-shrink: 0; }
.trait-title-group h3 { font-family: 'Fredoka', sans-serif; font-size: 1.2rem; font-weight: 600; margin-bottom: 0.15rem; }
.trait-title-group .aka { font-size: 0.82rem; color: var(--text-muted); font-style: italic; }
.trait-body { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
.trait-card.open .trait-body { max-height: 5000px; }
.trait-content { padding: 0 1.5rem 1.5rem; }
.trait-section-label { font-family: 'Fredoka', sans-serif; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; margin-bottom: 0.5rem; padding: 0.25rem 0.65rem; border-radius: 6px; display: inline-block; }
.label-what { background: rgba(78,205,196,0.15); color: #4ECDC4; }
.label-feel { background: rgba(255,107,107,0.15); color: #FF6B6B; }
.label-tool { background: rgba(107,203,119,0.15); color: #6BCB77; }

.tool-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06); border-radius: 12px; padding: 1rem 1.25rem; margin-bottom: 0.75rem; position: relative; }
.fav-btn { position: absolute; top: 0.75rem; right: 0.75rem; background: none; border: none; font-size: 1.2rem; cursor: pointer; opacity: 0.3; filter: grayscale(1); }
.fav-btn.favorited { opacity: 1; filter: grayscale(0); }

/* --- SOLVE IT GRID --- */
.solve-it-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0; }
.grid-quad { border-radius: 14px; padding: 1.5rem; position: relative; overflow: hidden; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06); }
.q-red { border-color: rgba(232,68,58,0.3); background: rgba(232,68,58,0.1); }
.q-yellow { border-color: rgba(245,166,35,0.3); background: rgba(245,166,35,0.1); }
.q-blue { border-color: rgba(74,144,217,0.3); background: rgba(74,144,217,0.1); }
.q-green { border-color: rgba(92,184,92,0.3); background: rgba(92,184,92,0.1); }

/* --- FOOTER --- */
.footer { text-align: center; padding: 3rem 1rem; color: #555; font-size: 0.8rem; border-top: 1px solid rgba(255,255,255,0.04); margin-top: 2rem; }
</style>
</head>
<body>

<div class="lang-picker">
  <span class="lang-icon">üåç</span>
  <select id="langSelect" onchange="setLanguage(this.value)" aria-label="Select Language">
    <option value="en">English</option>
    <option value="pt">Portugu√™s</option>
    <option value="es">Espa√±ol</option>
  </select>
</div>

<div class="hero">
  <h1 data-i18n="heroTitle">Name Your Beast</h1>
  <p class="subtitle" data-i18n="heroSubtitle">A complete map...</p>
  <p class="source-note" data-i18n="heroSource">Sources: Your Brain's Not Broken (Rosier) & The Adult ADHD Tool Kit (Ramsay/Rostain)</p>
</div>

<div class="nav-bar">
  <button class="nav-btn active" data-page="traits" data-i18n="nav.traits">üß† Traits & Tools</button>
  <button class="nav-btn" data-page="grid" data-i18n="nav.grid">üü• Solve-It Grid</button>
  <button class="nav-btn" data-page="patterns" data-i18n="nav.patterns">üîÅ Patterns</button>
  <button class="nav-btn" data-page="cbt" data-i18n="nav.cbt">‚öñÔ∏è CBT Toolkit</button>
  <button class="nav-btn" data-page="naming" data-i18n="nav.naming">üí° Name It</button>
  <button class="nav-btn nav-fav" data-page="favs" data-i18n="nav.favs">‚≠ê Favorites</button>
</div>

<div class="container">

  <div class="page active" id="page-traits">
    <div class="trait-grid" id="traitGrid"></div>
  </div>

  <div class="page" id="page-grid">
    <div class="solve-it-grid" id="solveItGridContainer">
        </div>
  </div>

  <div class="page" id="page-patterns">
    <div class="trait-grid" id="patternGrid"></div>
  </div>

  <div class="page" id="page-cbt">
    <div class="trait-grid" id="cbtGrid"></div>
  </div>

  <div class="page" id="page-naming">
    <div id="namingContainer" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:1rem;"></div>
  </div>

  <div class="page" id="page-favs">
    <div id="favsContainer"></div>
  </div>

</div>

<div class="footer" data-i18n="footer">Content synthesized from clinical sources. Not medical advice.</div>

<script src="locales/en.js"></script>
<script src="locales/pt.js"></script>
<script src="locales/es.js"></script>

<script>
// --- GLOBAL STATE ---
let traits = [];
let patterns = [];
let cbtTools = [];
let gridData = {};
let namingData = [];
const locales = { en: langEN, pt: langPT, es: langES };

// --- CORE FUNCTIONS ---
function renderTraitCard(t) {
  const favs = getFavorites();
  const toolsHTML = t.tools.map((tool, i) => {
    const favId = `${t.id}-tool-${i}`;
    const isFav = favs.includes(favId);
    return `
    <div class="tool-card">
      <button class="fav-btn ${isFav?'favorited':''}" data-fav-id="${favId}" onclick="event.stopPropagation();toggleFavorite('${favId}')">${isFav?'‚≠ê':'‚òÜ'}</button>
      <h4>üîß ${tool.name}</h4>
      <ol style="padding-left:1.2rem; margin-top:0.5rem; color:var(--text-muted); line-height:1.6; font-size:0.9rem;">
        ${tool.steps.map(s => `<li>${s}</li>`).join('')}
      </ol>
    </div>`;
  }).join('');

  return `
    <div class="trait-card" data-cat="${t.cat}">
      <div class="trait-header" onclick="this.parentElement.classList.toggle('open')">
        <div class="trait-icon" style="background:${t.color}22;color:${t.color}">${t.icon}</div>
        <div class="trait-title-group">
          <h3 style="color:${t.color}">${t.title}</h3>
          <div class="aka">${t.aka}</div>
        </div>
        <div style="margin-left:auto; opacity:0.5;">‚ñº</div>
      </div>
      <div class="trait-body"><div class="trait-content">
        <div style="margin-bottom:1rem"><span class="trait-section-label label-what">What</span> <p style="font-size:0.95rem; color:var(--text-muted); margin-top:0.3rem">${t.what}</p></div>
        <div style="margin-bottom:1rem"><span class="trait-section-label label-feel">Feels Like</span> <p style="font-size:0.95rem; color:var(--text-muted); margin-top:0.3rem">${t.feel}</p></div>
        <div><span class="trait-section-label label-tool">Tools</span> ${toolsHTML}</div>
      </div></div>
    </div>`;
}

function renderSimpleCard(p) {
    // Generic renderer for Patterns and CBT
    return `
    <div class="trait-card">
      <div class="trait-header" onclick="this.parentElement.classList.toggle('open')">
        <div class="trait-icon" style="background:${p.color}22;color:${p.color}">${p.icon}</div>
        <div class="trait-title-group"><h3 style="color:${p.color}">${p.title}</h3><div class="aka">${p.aka || ''}</div></div>
        <div style="margin-left:auto; opacity:0.5;">‚ñº</div>
      </div>
      <div class="trait-body"><div class="trait-content">
        <div style="margin-bottom:1rem"><p style="font-size:0.95rem; color:var(--text-muted);">${p.what}</p></div>
        ${p.strategies ? `<ul>${p.strategies.map(s => `<li style="padding:0.3rem 0; color:var(--text-muted)">‚Ä¢ ${s}</li>`).join('')}</ul>` : ''}
        ${p.tools ? p.tools.map(tool => `<div class="tool-card"><h4>${tool.name}</h4><ol style="padding-left:1.2rem; color:var(--text-muted)">${tool.steps.map(s=>`<li>${s}</li>`).join('')}</ol></div>`).join('') : ''}
      </div></div>
    </div>`;
}

function renderGrid() {
    const el = document.getElementById('solveItGridContainer');
    if(!gridData.red) return;
    el.innerHTML = `
        <div class="grid-quad q-red"><h3>${gridData.red.title}</h3><p style="font-size:0.9rem; color:var(--text-muted)">${gridData.red.desc}</p></div>
        <div class="grid-quad q-green"><h3>${gridData.green.title}</h3><p style="font-size:0.9rem; color:var(--text-muted)">${gridData.green.desc}</p></div>
        <div class="grid-quad q-yellow"><h3>${gridData.yellow.title}</h3><p style="font-size:0.9rem; color:var(--text-muted)">${gridData.yellow.desc}</p></div>
        <div class="grid-quad q-blue"><h3>${gridData.blue.title}</h3><p style="font-size:0.9rem; color:var(--text-muted)">${gridData.blue.desc}</p></div>
    `;
}

function renderNaming() {
    const el = document.getElementById('namingContainer');
    el.innerHTML = namingData.map(n => `
        <div class="tool-card" style="margin:0; height:100%">
            <h4 style="margin-bottom:0.5rem">${n.icon} ${n.title}</h4>
            <p style="font-size:0.9rem; color:var(--text-muted); line-height:1.5">${n.desc}</p>
        </div>
    `).join('');
}

// --- FAVORITES SYSTEM ---
function getFavorites() { try { return JSON.parse(localStorage.getItem('adhd-favorites') || '[]'); } catch { return []; } }
function toggleFavorite(id) {
  let favs = getFavorites();
  const idx = favs.indexOf(id);
  if (idx > -1) favs.splice(idx, 1); else favs.push(id);
  localStorage.setItem('adhd-favorites', JSON.stringify(favs));
  setLanguage(document.getElementById('langSelect').value); // Re-render to show update
}
function renderFavorites() {
    const favs = getFavorites();
    const container = document.getElementById('favsContainer');
    if (!favs.length) { container.innerHTML = '<div style="text-align:center; padding:3rem; color:var(--text-muted)">No favorites saved yet.</div>'; return; }
    
    // Find matching tools across traits and CBT
    let html = '';
    favs.forEach(favId => {
        // Search traits
        traits.forEach(t => {
            t.tools.forEach((tool, i) => {
                if (`${t.id}-tool-${i}` === favId) {
                    html += `<div class="tool-card" style="border-left:3px solid ${t.color}; margin-bottom:1rem">
                        <button class="fav-btn favorited" onclick="toggleFavorite('${favId}')">‚≠ê</button>
                        <h4>${t.icon} ${tool.name}</h4><div style="font-size:0.8rem; opacity:0.7; margin-bottom:0.5rem">from ${t.title}</div>
                        <ol style="padding-left:1.2rem; color:var(--text-muted)">${tool.steps.map(s => `<li>${s}</li>`).join('')}</ol>
                    </div>`;
                }
            });
        });
    });
    container.innerHTML = html;
}

// --- LANGUAGE ENGINE ---
function setLanguage(langCode) {
  const data = locales[langCode] || locales['en']; 
  localStorage.setItem('user-lang', langCode);
  document.getElementById('langSelect').value = langCode;

  // 1. Update text
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const keys = el.getAttribute('data-i18n').split('.');
    let val = data;
    keys.forEach(k => val = val ? val[k] : null);
    if(val) el.textContent = val;
  });

  // 2. Update Globals
  traits = data.traits || [];
  patterns = data.patterns || [];
  cbtTools = data.cbtTools || [];
  gridData = data.grid || {};
  namingData = data.naming || [];

  // 3. Render
  document.getElementById('traitGrid').innerHTML = traits.map(renderTraitCard).join('');
  document.getElementById('patternGrid').innerHTML = patterns.map(renderSimpleCard).join('');
  document.getElementById('cbtGrid').innerHTML = cbtTools.map(renderSimpleCard).join('');
  renderGrid();
  renderNaming();
  renderFavorites();
}

// --- NAV ---
document.querySelectorAll('.nav-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('page-' + btn.dataset.page).classList.add('active');
  });
});

// --- INIT ---
const savedLang = localStorage.getItem('user-lang');
const browserLang = navigator.language.slice(0, 2);
setLanguage(savedLang || (locales[browserLang] ? browserLang : 'en'));

</script>
</body>
</html>
